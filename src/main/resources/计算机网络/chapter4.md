### 网络层

转发（forwarding):分组在单一的路由器中从一条输入链路到选择一条输出链路的过程。
路由选择：涉及网络内所有路由器，从源到目的地节点所采用的的路径


转发表：每台路由器上有一个转发表，路由器通过检查输入分组的首部字段的值，然后根据该值
查询转发表，最终选择输出链路。

路由器接受路由选择协议配置器转发表

链路层交换机根据链路层分组的首部来转发分组，而路由器是根据网络层分组首部来转发分组

网路服务模型定义了分组在发送与接受端系统之间的运输特性。可选特性包含以下几种等：
1. 确保交付
2. 具有时延上界的确保交付
3. 有序分组交付
4. 确保最小带宽
5. 安全性服务
6. 差错检测与恢复


因特网的网络层提供了尽力而为的服务模型。

虚电路网络：在网络层仅提供有连接的服务
数据报网络：在网络层仅提供无连接的服务

网络层的连接服务需要所有参与的路由器来维护状态，而运输层的连接服务只在两个端系统内维护状态

### 网际协议

网络层有三个组件： IP协议， 路由选择协议， 因特网控制报文协议（ICMP)

IPV4数据报格式：
版本号：IP协议版本
首部长度，服务类型，数据报长度， 标识，标志，片偏移，寿命， 协议，源IP与目的IP，选项，数据有效载荷


由于不是所有链路层协议都能承载相同长度的分组，所以需要IP数据报分片


IPV4编址
IP地址不是随便选择的，而是取决于它所属的子网

IP广播地址：255.255.255.255，当主机发送一个目的地址为255.255.255.255的数据报时，该报文会被交付至同一个网络的所有主机，路由器
也会选择地向邻近的子网分发该报文（通常它们不会这么做）

DHCP协议：动态主机配置协议，允许主机自动获取一个IP地址，子网掩码，默认网关，本地dns信息等
四个步骤：
1. DHCP服务发现：使用UDP，发送DHCP发现报文，使用255.255.255.255广播地址，源地址：0.0.0.0
2. DHCP服务器提供： 收到DHCP发现报文后， 发送DHCP提供报文响应，包含推荐的IP地址，网络掩码， IP地址租用期等信息，依然使用广播地址
3. DHCP请求： 客户收到DHCP提供报文后，取出DHCP服务器地址，并向其发送DHCP请求报文，回显配置参数
4. DHCP ACK： 服务器发送ack 响应请求，确认参数




NAT（网络地址转换）
NAT转换表


ICMP：因特网控制报文协议
ICMP通常被认为是IP的一部分， 实际上从体系结构上来讲是位于IP之上的，因为ICMP的报文是由IP分组承载的
ICMP协议最典型的用途是差错报告， ICMP报文是作为IP的有效载荷承载的，类似的当主机收到一条指明上层协议为ICMP的数据报时，主机会解析出数据报的内容
给ICMP


路由选择算法
主机通常直接与一台路由器相连，称为默认路由器，第一跳路由器
当主机发送分组时，默认路由器称为源路由器，接受分组时，默认路由器称为目的路由器

全局式路由选择算法， 分散式路由选择算法
